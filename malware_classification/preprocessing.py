from numpy import array
from pandas import DataFrame
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.model_selection import train_test_split


def get_dataset() -> (DataFrame, DataFrame):
    with (open('api-call-traces/api_trace.csv', 'r') as csvfile,
          open('api-call-traces/api_trace_labels.txt', 'r') as labels):
        vectorizer = CountVectorizer()
        count_vector = vectorizer.fit_transform(csvfile.read().splitlines())

        df = DataFrame(
            data=count_vector.toarray(),
            columns=vectorizer.vocabulary
        )
        df.insert(df.shape[1], 'label', array(labels.read().splitlines()))
        return train_test_split(df, test_size=0.2, random_state=43)


if __name__ == '__main__':
    get_dataset().describe()