import sys

import skops.io as sio
from sklearn.feature_extraction.text import CountVectorizer


def load_model(filename: str):
    model = sio.load('model.skops')

    with open(filename, 'r') as f:
        vectorizer = CountVectorizer()
        vectorizer.fit(f.read().splitlines())
        for line in f:
            print(model.predict(vectorizer.transform([line])))


if __name__ == '__main__':
    if len(sys.argv) < 2:
        print('Usage classify-trace.py <filename>')
    # TODO: Put parameter in function
    load_model('api-call-traces/api_trace.csv')